!function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=e}();var debug=!1,canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),width=300,height=500,midHeight=height/2,player={x:width/2,y:height-5,width:30,height:35,speed:4,velX:0,velY:0,jumping:!1,jumpHold:null,jumpHoldTime:null,ghost:0,grounded:!1,dead:!1,score:0},splashAnimation={x:0,y:100,width:120,height:57,started:null},keys=[],friction=.8,gravity=.2,bottomIsDeath=!1;canvas.width=width,canvas.height=height;var squidNeutral=new Image;squidNeutral.src="/css/img/squid.png",squidNeutral.width=30,squidNeutral.height=35;var squidFocus1=new Image;squidFocus1.src="/css/img/squidJump1.png",squidFocus1.width=30,squidFocus1.height=35;var squidFocus2=new Image;squidFocus2.src="/css/img/squidJump2.png",squidFocus2.width=30,squidFocus2.height=35;var squidFocus3=new Image;squidFocus3.src="/css/img/squidJump3.png",squidFocus3.width=30,squidFocus3.height=35;var squidDead=new Image;squidDead.src="/css/img/squidDead.png",squidDead.width=30,squidDead.height=35;var splashVariant=Math.floor(7*Math.random()),splash=new Image;splash.src="/css/img/splash"+splashVariant+".png",splash.width=1560,splash.height=57,splash.className="splashImage";var myscore=0,hexGradients=["#F0ECDB","#F0F0DB","#ECF0DB","#E9F0DB","#E6F0DB","#E2F0DB","#DFF0DB","#DBF0DB","#DBF0DF","#DBF0E2","#DBF0E6","#DBF0E9","#DBF0EC","#DBF0F0","#DBECF0","#DBE9F0","#DBE6F0","#DBE2F0","#DBDFF0","#DBDBF0","#DFDBF0","#E2DBF0","#E6DBF0","#E9DBF0","#ECDBF0","#F0DBF0","#F0DBEC","#F0DBE9","#F0DBE6","#F0DBE2","#F0DBDF","#F0DBDB","#F0DFDB","#F0E2DB","#F0E6DB","#F0E9DB"],boxes=[];generateBasicPlatform(!0),generateBasicPlatform(!0),generateBasicPlatform(!0);var lastFrame=Date.now()-1,thisFrame=Date.now();function frameRate(){var e=Date.now(),a=Math.floor(1e3/(e-lastFrame));lastFrame=e,debug&&(ctx.font="12px SplatRegular",ctx.fillText(a+" fps",10,16))}function setScore(){ctx.font="16px SplatRegular",ctx.fillStyle="black",ctx.fillText("Score: "+player.score.toString().padStart(4,"0"),width-100,20)}const SPLASH_ANIMATION_FRAME_RATE=15;function animateSplash(){if(splashAnimation.started){var e=Math.floor((thisFrame-splashAnimation.started)/SPLASH_ANIMATION_FRAME_RATE);if(e>11&&(splashAnimation.started=null),ctx.drawImage(splash,e*splashAnimation.width,0,splashAnimation.width,splashAnimation.height,splashAnimation.x,splashAnimation.y,splashAnimation.width,splashAnimation.height),splashAnimation.x>width-120){var a=splashAnimation.width+splashAnimation.x-width;ctx.drawImage(splash,e*splashAnimation.width+splashAnimation.width-a,0,a,splashAnimation.height,0,splashAnimation.y,a,splashAnimation.height)}}}function generateBasicPlatform(e){var a=boxes.length?boxes[boxes.length-1].y-150*Math.random()-(e?100:0):height-100-(e?100:0),t=Math.random()*(width-30);!e&&a>0&&(a=0);var i=100*Math.random()+30;boxes.push({x:t,y:a,width:i,height:5,count:boxes.length?boxes[boxes.length-1].count+1:1})}function update(){if(thisFrame=Date.now(),player.dead)return ctx.font="60px SplatRegular",ctx.fillText("Game Over",10,100,width-20),frameRate(),myscore=player.score,void(document.getElementById("share").style.display="");keys[40]||keys[32]?player.jumping||player.jumpHold||(player.jumpHold=Math.round(Date.now()/1),player.jumpHoldTime=null,debug&&console.log("holding")):player.jumping||(null!==player.jumpHold&&null===player.jumpHoldTime?(debug&&console.log("jumping"),player.jumping=!0,player.grounded=!1,player.jumpHoldTime=Math.round(Date.now()/1)-player.jumpHold,player.jumpHoldTime>1e3?player.jumpHoldTime=1e3:player.jumpHoldTime<500&&(player.jumpHoldTime=500),player.jumpHoldTime=player.speed*(player.jumpHoldTime/650),player.jumpHold=null,player.y-=1,player.velY=-2*player.jumpHoldTime,splashAnimation.started=thisFrame,splashAnimation.x=player.x-45,splashAnimation.x<0&&(splashAnimation.x=width-Math.abs(splashAnimation.x)),splashAnimation.y=player.y-18):null===player.jumpHold&&null!==player.jumpHoldTime&&(debug&&console.log("resetting"),player.jumpHoldTime=null)),keys[39]&&player.jumping&&player.velX<player.speed&&player.velX++,keys[37]&&player.jumping&&player.velX>-player.speed&&player.velX--,player.velX*=friction,player.velY+=gravity,ctx.clearRect(0,0,width,height);var e,a,t=300/hexGradients.length,i=Math.floor(player.score/t)%hexGradients.length;ctx.fillStyle=hexGradients[i],ctx.fillRect(0,0,width,height),ctx.fillStyle="black",ctx.beginPath(),player.grounded=!1;for(var l=0;l<boxes.length;l++){ctx.rect(boxes[l].x,boxes[l].y,boxes[l].width,boxes[l].height);var s=colCheck(player,boxes[l]);"l"===s||"r"===s?player.velX=0:"b"===s?(player.grounded=!0,player.jumping=!1):"t"===s&&(player.velY*=-1)}if(ctx.fill(),player.grounded&&(player.velY=0),player.x+=player.velX,player.y+=player.velY,player.x<0?player.x=width+player.x:player.x>width&&(player.x=player.x-width),player.x<0&&player.x>-1*player.width?(player.ghost=1,player.x=width-Math.abs(player.x)):player.x>width-player.width&&player.x<width+player.width?player.ghost=1:player.ghost=0,player.y>=height-player.height&&(player.y=height-player.height,player.jumping=!1,bottomIsDeath&&(player.dead=!0)),player.y<=midHeight){bottomIsDeath=!0;var r=player.y-midHeight;player.y=midHeight;for(l=0;l<boxes.length;l++)boxes[l].y-=r;boxes[0].y>height&&(boxes.shift(),generateBasicPlatform()),splashAnimation.y-=r}if(player.dead)e=squidDead,a=squidDead;else if(player.jumping)e=squidNeutral,a=squidNeutral;else if(player.jumpHold){var o=Math.round(Date.now()/1)-player.jumpHold;o>1e3?(e=squidFocus3,a=squidFocus3):o<500?(e=squidFocus1,a=squidFocus1):(e=squidFocus2,a=squidFocus2)}else e=squidNeutral,a=squidNeutral;if(player.jumping&&animateSplash(),ctx.drawImage(e,player.x,player.y,squidNeutral.width,squidNeutral.height),0!==player.ghost&&1===player.ghost){var n=player.width+player.x-width,h=n/squidNeutral.width*100;ctx.drawImage(a,100-h,0,h,117,0,player.y,n,squidNeutral.height)}frameRate(),setScore(),requestAnimationFrame(update)}function colCheck(e,a){var t=e.x+e.width/2-(a.x+a.width/2),i=e.y+e.height/2-(a.y+a.height/2),l=e.width/2+a.width/2,s=e.height/2+a.height/2,r=null;if(Math.abs(t)<l&&Math.abs(i)<s){var o=l-Math.abs(t),n=s-Math.abs(i);o>=n?i>0?(r="t",e.y+=n):(r="b",e.y-=n,player.score<a.count&&(player.score=a.count)):t>0?(r="l",e.x+=o):(r="r",e.x-=o)}return r}function share(){var e="https://twitter.com/intent/tweet?text=I%20made%20it%20to%20"+myscore+"%20platforms%20on%20r/Splatoon%20Hop!%20%23rsplatoonhop%20%23Splatoon%20How%20high%20can%20you%20go?%20https%3A%2F%2Fminigame.rsplatoon.com%2F";window.open(e,"_blank")}document.body.addEventListener("keydown",function(e){keys[e.keyCode]=!0}),document.body.addEventListener("keyup",function(e){keys[e.keyCode]=!1}),window.addEventListener("load",function(){update()});
!function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=e}();var debug=!1;function isTouchDevice(){return"ontouchstart"in document.documentElement}var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),width=300,height=500,midHeight=height/2,player={x:width/2,y:height-5,width:30,height:35,speed:4,velX:0,velY:0,jumping:!1,jumpHold:null,jumpHoldTime:null,ghost:0,grounded:!1,dead:!1,score:0},splashAnimation={x:0,y:100,width:120,height:57,started:null},keys=[],friction=.8,gravity=.2,bottomIsDeath=!1;canvas.width=width,canvas.height=height;var squidNeutral=new Image;squidNeutral.src="/css/img/squid.png",squidNeutral.width=30,squidNeutral.height=35;var squidFocus1=new Image;squidFocus1.src="/css/img/squidJump1.png",squidFocus1.width=30,squidFocus1.height=35;var squidFocus2=new Image;squidFocus2.src="/css/img/squidJump2.png",squidFocus2.width=30,squidFocus2.height=35;var squidFocus3=new Image;squidFocus3.src="/css/img/squidJump3.png",squidFocus3.width=30,squidFocus3.height=35;var squidDead=new Image;squidDead.src="/css/img/squidDead.png",squidDead.width=30,squidDead.height=35;var splashVariant=Math.floor(7*Math.random()),splash=new Image;splash.src="/css/img/splash"+splashVariant+".png",splash.width=1560,splash.height=57,splash.className="splashImage";var myscore=0,hexGradients=["#F0ECDB","#F0F0DB","#ECF0DB","#E9F0DB","#E6F0DB","#E2F0DB","#DFF0DB","#DBF0DB","#DBF0DF","#DBF0E2","#DBF0E6","#DBF0E9","#DBF0EC","#DBF0F0","#DBECF0","#DBE9F0","#DBE6F0","#DBE2F0","#DBDFF0","#DBDBF0","#DFDBF0","#E2DBF0","#E6DBF0","#E9DBF0","#ECDBF0","#F0DBF0","#F0DBEC","#F0DBE9","#F0DBE6","#F0DBE2","#F0DBDF","#F0DBDB","#F0DFDB","#F0E2DB","#F0E6DB","#F0E9DB"],boxes=[];generateBasicPlatform(!0),generateBasicPlatform(!0),generateBasicPlatform(!0);var lastFrame=Date.now()-1,thisFrame=Date.now();function frameRate(){var e=Date.now(),t=Math.floor(1e3/(e-lastFrame));lastFrame=e,debug&&(ctx.font="12px SplatRegular",ctx.fillText(t+" fps",10,16))}function setScore(){ctx.font="16px SplatRegular",ctx.fillStyle="black",ctx.fillText("Score: "+player.score.toString().padStart(4,"0"),width-100,20)}const SPLASH_ANIMATION_FRAME_RATE=15;function animateSplash(){if(splashAnimation.started){var e=Math.floor((thisFrame-splashAnimation.started)/SPLASH_ANIMATION_FRAME_RATE);if(e>11&&(splashAnimation.started=null),ctx.drawImage(splash,e*splashAnimation.width,0,splashAnimation.width,splashAnimation.height,splashAnimation.x,splashAnimation.y,splashAnimation.width,splashAnimation.height),splashAnimation.x>width-120){var t=splashAnimation.width+splashAnimation.x-width;ctx.drawImage(splash,e*splashAnimation.width+splashAnimation.width-t,0,t,splashAnimation.height,0,splashAnimation.y,t,splashAnimation.height)}}}function generateBasicPlatform(e){var t=boxes.length?boxes[boxes.length-1].y-150*Math.random()-(e?100:0):height-100-(e?100:0),a=Math.random()*(width-30);!e&&t>0&&(t=0);var s=100*Math.random()+30;boxes.push({x:a,y:t,width:s,height:5,count:boxes.length?boxes[boxes.length-1].count+1:1})}function update(){if(thisFrame=Date.now(),player.dead)return ctx.font="60px SplatRegular",ctx.fillText("Game Over",10,100,width-20),frameRate(),myscore=player.score,void(document.getElementById("share").style.display="");keys[40]||keys[32]||keys.touch&&keys.touch.length&&"end"!==keys.touch[keys.touch.length-1].action?player.jumping||player.jumpHold||(player.jumpHold=Math.round(Date.now()/1),player.jumpHoldTime=null,debug&&console.log("holding")):player.jumping||(null!==player.jumpHold&&null===player.jumpHoldTime?(debug&&console.log("jumping"),player.jumping=!0,player.grounded=!1,player.jumpHoldTime=Math.round(Date.now()/1)-player.jumpHold,player.jumpHoldTime>1e3?player.jumpHoldTime=1e3:player.jumpHoldTime<500&&(player.jumpHoldTime=500),player.jumpHoldTime=player.speed*(player.jumpHoldTime/650),player.jumpHold=null,player.y-=1,player.velY=-2*player.jumpHoldTime,splashAnimation.started=thisFrame,splashAnimation.x=player.x-45,splashAnimation.x<0&&(splashAnimation.x=width-Math.abs(splashAnimation.x)),splashAnimation.y=player.y-18):null===player.jumpHold&&null!==player.jumpHoldTime&&(debug&&console.log("resetting"),player.jumpHoldTime=null)),(keys[39]&&player.jumping||keys.touch&&keys.touch.length&&player.jumping&&player.x<keys.touch[keys.touch.length-1].x-86)&&(keys.touch&&keys.touch.length>1&&"end"!==keys.touch[keys.touch.length-1].action&&(keys.touch=[keys.touch[keys.touch.length-1]]),keys.touch&&keys.touch.length&&player.velX<0&&"end"!==keys.touch[keys.touch.length-1].action&&(player.velX=0),keys.touch&&"end"===keys.touch[keys.touch.length-1].action&&(keys.touch[keys.touch.length-1].x=width+1e4),player.velX<player.speed&&player.velX++),(keys[37]&&player.jumping||keys.touch&&keys.touch.length&&player.jumping&&player.x>keys.touch[keys.touch.length-1].x-52)&&(keys.touch&&keys.touch.length>1&&"end"!==keys.touch[keys.touch.length-1].action&&(keys.touch=[keys.touch[keys.touch.length-1]]),keys.touch&&keys.touch.length&&player.velX>0&&"end"!==keys.touch[keys.touch.length-1].action&&(player.velX=0),keys.touch&&"end"===keys.touch[keys.touch.length-1].action&&(keys.touch[keys.touch.length-1].x=-1e4),player.velX>-player.speed&&player.velX--),player.velX*=friction,player.velY+=gravity,ctx.clearRect(0,0,width,height);var e,t,a=300/hexGradients.length,s=Math.floor(player.score/a)%hexGradients.length;ctx.fillStyle=hexGradients[s],ctx.fillRect(0,0,width,height),ctx.fillStyle="black",ctx.beginPath(),player.grounded=!1;for(var l=0;l<boxes.length;l++){ctx.rect(boxes[l].x,boxes[l].y,boxes[l].width,boxes[l].height);var i=colCheck(player,boxes[l]);"l"===i||"r"===i?player.velX=0:"b"===i?(player.grounded=!0,player.jumping=!1):"t"===i&&(player.velY*=-1)}if(ctx.fill(),player.grounded&&(player.velY=0),player.x+=player.velX,player.y+=player.velY,player.x<0?player.x=width+player.x:player.x>width&&(player.x=player.x-width),player.x<0&&player.x>-1*player.width?(player.ghost=1,player.x=width-Math.abs(player.x)):player.x>width-player.width&&player.x<width+player.width?player.ghost=1:player.ghost=0,player.y>=height-player.height&&(player.y=height-player.height,player.jumping=!1,keys.touch&&keys.touch.length&&"end"===keys.touch[keys.touch.length-1].action&&(keys.touch=null),bottomIsDeath&&(player.dead=!0)),player.y<=midHeight){bottomIsDeath=!0;var o=player.y-midHeight;player.y=midHeight;for(l=0;l<boxes.length;l++)boxes[l].y-=o;boxes[0].y>height&&(boxes.shift(),generateBasicPlatform()),splashAnimation.y-=o}if(player.dead)e=squidDead,t=squidDead;else if(player.jumping)e=squidNeutral,t=squidNeutral;else if(player.jumpHold){var n=Math.round(Date.now()/1)-player.jumpHold;n>1e3?(e=squidFocus3,t=squidFocus3):n<500?(e=squidFocus1,t=squidFocus1):(e=squidFocus2,t=squidFocus2)}else e=squidNeutral,t=squidNeutral;if(player.jumping&&animateSplash(),ctx.drawImage(e,player.x,player.y,squidNeutral.width,squidNeutral.height),0!==player.ghost&&1===player.ghost){var h=player.width+player.x-width,r=h/squidNeutral.width*100;ctx.drawImage(t,100-r,0,r,117,0,player.y,h,squidNeutral.height)}frameRate(),setScore(),requestAnimationFrame(update)}function colCheck(e,t){var a=e.x+e.width/2-(t.x+t.width/2),s=e.y+e.height/2-(t.y+t.height/2),l=e.width/2+t.width/2,i=e.height/2+t.height/2,o=null;if(Math.abs(a)<l&&Math.abs(s)<i){var n=l-Math.abs(a),h=i-Math.abs(s);n>=h?s>0?(o="t",e.y+=h):(o="b",e.y-=h,player.score<t.count&&(player.score=t.count)):a>0?(o="l",e.x+=n):(o="r",e.x-=n)}return o}function touchStart(e){e.preventDefault(),debug&&console.log("touchstart.");var t=e.changedTouches,a=t[0].clientX,s=t[0].clientY;keys.touch=[{x:a,y:s,action:"start"}]}function touchMove(e){e.preventDefault(),debug&&console.log("touchstart.");var t=e.changedTouches,a=t[0].clientX,s=t[0].clientY;keys.touch.push({x:a,y:s,action:"move"})}function touchEnd(e){e.preventDefault(),debug&&console.log("touchstart.");var t=e.changedTouches,a=t[0].clientX,s=t[0].clientY;keys.touch.push({x:a,y:s,action:"end"})}function share(){var e="https://twitter.com/intent/tweet?text=I%20made%20it%20to%20"+myscore+"%20platforms%20on%20r/Splatoon%20Hop!%20%23rsplatoonhop%20%23Splatoon%20How%20high%20can%20you%20go?%20https%3A%2F%2Fminigame.rsplatoon.com%2F";window.open(e,"_blank")}document.body.addEventListener("keydown",function(e){keys[e.keyCode]=!0}),document.body.addEventListener("keyup",function(e){keys[e.keyCode]=!1}),window.addEventListener("load",function(){update()}),canvas.addEventListener("touchstart",touchStart,!1),canvas.addEventListener("touchmove",touchMove,!1),canvas.addEventListener("touchend",touchEnd,!1),isTouchDevice()&&(document.getElementById("mobileControls").style.display="",document.getElementById("desktopControls").style.display="none");